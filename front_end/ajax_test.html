
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>


    <script type="text/javascript">
        var xmlhttp;

        // Are we using a modern browser or ...
        if (window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }


        function receive_ag() {
            var json = {"io": "1000", "mem": "12", "cpu": "33"};
            document.getElementById("info").innerHTML = "Average parameters per specified time block:";
            document.getElementById("io_average").innerHTML = "I/O disk:" + " " + json["io"];
            document.getElementById("mem_average").innerHTML = "Memory space:" + " " + json["mem"];
            document.getElementById("cpu_average").innerHTML = "CPU time:" + " " + json["cpu"];
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                // var jsonobj = eval ("(" + xmlhttp.responseText + ")");
                var jsonobj = JSON.parse(xmlhttp.responseText);

                var output = xmlhttp.responseText;


                output = "";

                for (i in jsonobj) {
                    output += '<p>';
                    output += i + " : " + jsonobj[i];
                    output += '</p>';
                }



            } else {
                alert("data not available");
            }
        }

        xmlhttp.onload = receive_ag;

        function request_ag(id) {
            var dict = form_params(id);
            var query = generateQuery(dict);
            console.log(query);
            xmlhttp.open("POST", "/getallitems.json?" + query, true);
            xmlhttp.send();
        }

        function generateQuery(obj) {
            var str = [];
            for (var p in obj)
                if (obj.hasOwnProperty(p)) {
                    str.push(encodeURIComponent(p) + "=" + encodeURIComponent(obj[p]));
                }
            return str.join("&");
        }

        function form_params(form) {
            var params = [];
            var length = form.elements.length;
            for (var i = 0; i < length; i++) {
                element = form.elements[i];

                if (element.tagName == 'TEXTAREA') {
                    params[element.name] = element.value
                }
                else if (element.tagName == 'INPUT') {
                    if (element.type == 'text' || element.type == 'hidden' || element.type == 'password') {
                        params[element.name] = element.value
                    }
                    else if (element.type == 'radio' && element.checked) {
                        if (!element.value)
                            params[element.name] = "on";
                        else
                            params[element.name] = element.value

                    }
                    else if (element.type == 'checkbox' && element.checked) {
                        if (!element.value)
                            params[element.name] = "on";
                        else
                            params[element.name] = element.value
                    }
                }
            }
            return params;
        }


        // xmlhttp.onreadystatechange = GetArticles;
        // the receive function will be triggered once the ajax
        // request is terminated.

    </script>
</head>

<body>


<h2>Aggregated values</h2>

<p>Input unit time block that you are interested in:</p>

<form id="aggregated" class="myClass">
    <input type="text" name="time_block"><br> <br>
    <button onClick="request_ag(document.getElementById('aggregated')); return false; " class="btn btn-primary"
            id="time_block_btn">Show values
    </button>
    <br>
</form>
<br>


<div id="info"></div>
<br/>

<div id="io_average"></div>
<br/>

<div id="mem_average"></div>
<br/>

<div id="cpu_average"></div>

</body>
</html>